---
title: 'Topics in Labor & Demo: Midterm Problem Set'
author: "Gabriel Tabak, Guilherme Cabrine & Gustavo Henrique"
date: '`r Sys.Date()`'
output: pdf_document
encoding: UTF-8
---


```{r, echo=FALSE}
## Loading/Installing needed packages
pacman::p_load(tidyverse,
               estimatr,
               stats,
               stargazer,
               haven,
               here,
               patchwork,
               readxl)
```

# Question 1

```{r, echo=FALSE}
## Importing databases
# Importing SDEM final dataset
sdem = read_csv(here("Data/Final", "sdem.csv"))

# Cleaning memory
gc()

# Price index Data
mexcpi = read_excel(here("Data/Raw", "MEXCPIALLAINMEI.xlsx"),
                     sheet = "Annual") %>% 
  mutate(year = as.numeric(format(observation_date, "%Y"))) %>% 
  rename(cpi = MEXCPIALLAINMEI) %>% 
  select(-1)
```

### Item a
```{r, echo=FALSE}
# Get some household variables 
sdem_agg = sdem %>% group_by(cd_a, ent, con, v_sel, n_hog, h_mud, year) %>%
  summarise(age_hhead = eda[which(par_c == 101)],
            age_hspouse = first(eda[par_c %in% c(201,202)]),
            chld_less16 = as.integer(sum(par_c %in% c(301,302,303) &
                                           eda < 16) > 0))

# Join with the data
sdem = sdem %>% 
  left_join(sdem_agg)

# Removing unneeded df
rm(sdem_agg)

## Employed 
# hrsocu > 0 and non empty, also, age_hhead > 13 and age_hhead <= 98
sdem = sdem %>%
  mutate(Employed = ifelse((hrsocup >0) & (age_hhead <= 98) & (age_hhead > 13),
                                                    1, 0))

# Get the conditional hours
sdem$HourC = ifelse(sdem$Employed == 1,
                          sdem$hrsocup, NA)

# Deflate the salary
sdem = sdem %>% 
  left_join(mexcpi, by = c("year"))

sdem = sdem %>%
  mutate(Wage = 52*ing_x_hrs*hrsocup*(100/cpi))  

df1 = sdem %>% 
  filter(sex == 2, 
         eda %in% 25:65) %>% 
  group_by(year) %>%
  summarise(EmplR = mean(Employed),
            YWage = mean(Wage),
            Hrs = mean(hrsocup),
            HrsC = mean(HourC, na.rm = T)) %>% 
  mutate(year = as.factor(year))

g1 = ggplot(df1, aes(year, EmplR)) + geom_point() + 
  geom_line(aes(group = 1)) + theme_bw() +
  ylab("Employment")

g2 = ggplot(df1, aes(year, YWage)) + geom_point() + 
  geom_line(aes(group = 1)) +theme_bw() +
  ylab("Mean yearly Wage")

g3 = ggplot(df1, aes(year, Hrs)) + geom_point() + 
  geom_line(aes(group = 1)) + theme_bw() +
  ylab("Hours Occupied by week Unconditionl")

g4 = ggplot(df1, aes(year, HrsC)) + geom_point() + 
  geom_line(aes(group = 1)) + theme_bw() +
  ylab("Hours Occupied by week Conditionl")

(g1 | g2) / (g3 | g4)
ggsave(here("Out", "plot1.png"), width = 12, height = 12, dpi=600)

rm(g1, g2, g3, g4, df1)
```

### Item b
```{r, echo=FALSE}
df = sdem %>%
  filter(sex == 2, eda %in% 25:65) %>% 
  mutate(hj_peq = case_when(
    n_hij != 0 & chld_less16 != 0 & (par_c %in% c(101,201)) ~ 1,
    T ~ 0
  ))

Tables = function(df1, status){
  df1 = df1 %>% 
    filter(e_con == status)
  
  final = matrix(0, 5, 8)
  final = data.frame(final)
  
  # All
  final[1,c(1,5)] = c(mean(df1$Employed), mean(df1$Wage/52))
  
  final[1,c(2,6)] = df1 %>% 
    filter(cs_p13_1 < 4) %>%
    summarise(mean(Employed), mean(Wage/52)) %>%
    as.numeric()
  
  final[1,c(3,7)] = df1 %>% 
    filter(cs_p13_1 == 4) %>% 
    summarise(mean(Employed), mean(Wage/52)) %>%
    as.numeric()
  
  final[1,c(4,8)] = df1 %>%
    filter(cs_p13_1 %in% c(7,8,9)) %>% 
    summarise(mean(Employed), mean(Wage/52)) %>%
    as.numeric()
  
  # Less than 35 with young child
  final[2,c(1,5)] = df1 %>% 
    filter(hj_peq == 1, eda < 35) %>% 
    summarise(mean(Employed), mean(Wage/52)) %>%
    as.numeric()
  
  final[2,c(2,6)] = df1 %>% 
    filter(hj_peq == 1, eda < 35, cs_p13_1 < 4) %>% 
    summarise(mean(Employed), mean(Wage/52)) %>%
    as.numeric()
  
  final[2,c(3,7)] = df1 %>% 
    filter(hj_peq == 1, eda < 35, cs_p13_1 == 4) %>% 
    summarise(mean(Employed), mean(Wage/52)) %>%
    as.numeric()
  
  final[2,c(4,8)] = df1 %>% 
    filter(hj_peq == 1, eda < 35,cs_p13_1 %in% c(7,8,9)) %>%
    summarise(mean(Employed), mean(Wage/52)) %>%
    as.numeric()
  
  # Less than 35 with no child
  final[3,c(1,5)] = df1 %>% 
    filter(hj_peq == 0, eda < 35) %>% 
    summarise(mean(Employed), mean(Wage/52)) %>%
    as.numeric()
  
  final[3,c(2,6)] = df1 %>%
    filter(hj_peq == 0, eda < 35,cs_p13_1 < 4) %>%
    summarise(mean(Employed), mean(Wage/52)) %>%
    as.numeric()
  
  final[3,c(3,7)] = df1 %>%
    filter(hj_peq == 0, eda < 35,cs_p13_1 == 4) %>%
    summarise(mean(Employed), mean(Wage/52)) %>%
    as.numeric()
  
  final[3,c(4,8)] = df1 %>% 
    filter(hj_peq == 0, eda < 35,cs_p13_1 %in% c(7,8,9)) %>%
    summarise(mean(Employed), mean(Wage/52)) %>%
    as.numeric()
  
  
  # Edad: 35-54
  final[4,c(1,5)] = df1 %>% 
    filter(eda >= 35, eda<=54) %>% 
    summarise(mean(Employed), mean(Wage/52)) %>%
    as.numeric()
  
  final[4,c(2,6)] = df1 %>%
    filter(eda >= 35, eda<=54,cs_p13_1 < 4) %>% 
    summarise(mean(Employed), mean(Wage/52)) %>%
    as.numeric()
  
  final[4,c(3,7)] = df1 %>%
    filter(eda >= 35, eda<=54,cs_p13_1 == 4) %>%
    summarise(mean(Employed), mean(Wage/52)) %>%
    as.numeric()
  
  final[4,c(4,8)] = df1 %>%
    filter(eda >= 35, eda<=54,cs_p13_1 %in% c(7,8,9)) %>%
    summarise(mean(Employed), mean(Wage/52)) %>%
    as.numeric()
  
  # Edad: 55+
  final[5,c(1,5)] = df1 %>% 
    filter(eda >= 55) %>% 
    summarise(mean(Employed), mean(Wage/52)) %>%
    as.numeric()
  
  final[5,c(2,6)] = df1 %>% 
    filter(eda >= 55,cs_p13_1 < 4) %>% 
    summarise(mean(Employed), mean(Wage/52)) %>%
    as.numeric()
  
  final[5,c(3,7)] = df1 %>% 
    filter(eda >= 55,cs_p13_1 == 4) %>%
    summarise(mean(Employed), mean(Wage/52)) %>%
    as.numeric()
  
  final[5,c(4,8)] = df1 %>% 
    filter(eda >= 55,cs_p13_1 %in% c(7,8,9)) %>%
    summarise(mean(Employed), mean(Wage/52)) %>%
    as.numeric()
  
  rownames(final) = c("All", "Less 35 - Young Chld",
                       "Less 35 - No Chld", "35-54",
                       "55+")
  
  colnames(final) = c("All", "Less HS", "HS", "College+",
                       "All - W", "Less HS - W", "HS - W", "College+ - W")  
  return(final)
}


# Marital status: 5 = Married, 1 = Cohabiting & 6 = Single

Tables(df,5)
Tables(df,1)
Tables(df,6)
```

### Item c
```{r, echo=FALSE}
## household chores W
df = sdem %>% 
  filter(e_con %in% c(1,5),
         sex == 2,
         eda %in% 25:65,
         par_c %in% c(101,201))

## household chores man
dfM = sdem %>% 
  filter(e_con %in% c(1,5),
         sex == 1,
         par_c %in% c(101,201))

# Removing unneeded df
rm(sdem)

# Cleaning memory
gc()

# Remove pairs with 2 W
Aux = df %>% 
  group_by(cd_a, ent, con, v_sel, n_hog, h_mud, year) %>% 
  summarise(n = n()) %>% 
  filter(n>1) 

X = paste(df$cd_a, df$ent, df$con, df$v_sel,
           df$n_hog, df$h_mud, df$year)
X2 = paste(Aux$cd_a, Aux$ent, Aux$con, Aux$v_sel,
            Aux$n_hog, Aux$h_mud, Aux$year)

df = df[!X%in%X2,]

rm(X, X2, Aux)

df$p11_h2 = ifelse(is.na(df$p11_h2), 0, df$p11_h2)
df$p11_h5 = ifelse(is.na(df$p11_h5), 0, df$p11_h5)
df$p11_h7 = ifelse(is.na(df$p11_h7), 0, df$p11_h7)
df$p11_m2 = ifelse(is.na(df$p11_m2), 0, df$p11_m2)
df$p11_m5 = ifelse(is.na(df$p11_m5), 0, df$p11_m5)
df$p11_m7 = ifelse(is.na(df$p11_m7), 0, df$p11_m7)

df = df %>% 
  filter(p11_h2 != 98, p11_h5 != 98, p11_h7 != 98)

df$p11_h2 = ifelse(df$p11_h2 == 99 | is.na(df$p11_h2), 0, df$p11_h2)
df$p11_h5 = ifelse(df$p11_h5 == 99 | is.na(df$p11_h5), 0, df$p11_h5)
df$p11_h7 = ifelse(df$p11_h7 == 99 | is.na(df$p11_h7), 0, df$p11_h7)


df$hhChores_W = ifelse(df$year < 2013,  df$p11_h2*60 + df$p11_m2 +
                                         df$p11_h5*60 + df$p11_m5,0)
df$hhChores_W = ifelse(df$year >= 2013, df$p11_h2*60 + df$p11_m2 +
                                         df$p11_h7*60 + df$p11_m7, df$hhChores_W)

df %>% 
  ggplot() +
  geom_histogram(mapping = aes(hhChores_W/60))

# Remove pairs with 2 M
Aux = dfM %>% 
  group_by(cd_a, ent, con, v_sel, n_hog, h_mud, year) %>% 
  summarise(n = n()) %>% 
  filter(n>1) 

X = paste(dfM$cd_a, dfM$ent, dfM$con, dfM$v_sel,
           dfM$n_hog, dfM$h_mud, dfM$year)
X2 = paste(Aux$cd_a, Aux$ent, Aux$con, Aux$v_sel,
            Aux$n_hog, Aux$h_mud, Aux$year)

dfM = dfM[!X%in%X2,]

rm(X, X2, Aux)

dfM$p11_h2 = ifelse(is.na(dfM$p11_h2), 0, dfM$p11_h2)
dfM$p11_h5 = ifelse(is.na(dfM$p11_h5), 0, dfM$p11_h5)
dfM$p11_h7 = ifelse(is.na(dfM$p11_h7), 0, dfM$p11_h7)
dfM$p11_m2 = ifelse(is.na(dfM$p11_m2), 0, dfM$p11_m2)
dfM$p11_m5 = ifelse(is.na(dfM$p11_m5), 0, dfM$p11_m5)
dfM$p11_m7 = ifelse(is.na(dfM$p11_m7), 0, dfM$p11_m7)

dfM = dfM %>%
  filter(p11_h2 != 98, p11_h5 != 98, p11_h7 != 98)

dfM$p11_h2 = ifelse(dfM$p11_h2 == 99 | is.na(dfM$p11_h2), 0, dfM$p11_h2)
dfM$p11_h5 = ifelse(dfM$p11_h5 == 99 | is.na(dfM$p11_h5), 0, dfM$p11_h5)
dfM$p11_h7 = ifelse(dfM$p11_h7 == 99 | is.na(dfM$p11_h7), 0, dfM$p11_h7)

dfM$hhChores_M = ifelse(dfM$year < 2013,  dfM$p11_h2*60 + dfM$p11_m2 +
                           dfM$p11_h5*60 + dfM$p11_m5,0)

dfM$hhChores_M = ifelse(dfM$year >= 2013, dfM$p11_h2*60 + dfM$p11_m2 +
                           dfM$p11_h7*60 + dfM$p11_m7, dfM$hhChores_M)

dfM %>%
  ggplot() + 
  geom_histogram(mapping = aes(hhChores_M/60))

dfM = dfM %>%
  select(cd_a, ent, con, v_sel, n_hog, 
                      h_mud, n_ren, n_pro_viv, year, hhChores_M)

#### Join- W + M
df = df %>%
  left_join(dfM, by = c("cd_a", "ent", "con", "v_sel", "n_hog", "h_mud", "year"))

df = df[!is.na(df$hhChores_M),]

df %>% filter(e_con == 1) %>%
  group_by(year) %>% 
  summarise(Ratio = mean(hhChores_W/(hhChores_M + hhChores_W), na.rm = T))

df %>% filter(e_con == 5) %>%
  group_by(year) %>% 
  summarise(Ratio = mean(hhChores_W/(hhChores_M + hhChores_W), na.rm = T))

df %>% 
  group_by(year, e_con) %>% 
  summarise(Ratio = mean(hhChores_W/(hhChores_M + hhChores_W), na.rm = TRUE)) %>%
  mutate(status = case_when(
    e_con == 1 ~ "Cohabiting",
    T ~ "Married"
  )) %>% 
  ggplot(aes(x = year, y = Ratio, color = as.factor(status))) + 
  geom_point() +
  geom_line() + 
  theme_bw() +
  labs(color = "Marital status") + 
  scale_x_continuous(breaks = unique(df$year))

rm(df, dfM)
```

### Item d
```{r, echo=FALSE}
## Importing databases
VivEni = read_csv(here("Data/Raw", "viviendas.csv"))
ConcEni = read_csv(here("Data/Raw", "concentradohogar.csv"))
PobEni = read_csv(here("Data/Raw", "poblacion.csv"))
GasEni = read_csv(here("Data/Raw", "gastoshogar.csv"))

# Get Home Ownership
VivEni = VivEni %>% 
  filter(tenencia != 6) %>%
  mutate(homeownership = ifelse(tenencia %in% c(1,2,5), 0, 1))

# Get daycar, insurances, child care
GasEni = GasEni %>% mutate(health_ins = ifelse(clave %in% c("J070", "J071", "J072"),
                                                gasto_tri, 0),
                            other_ins  = ifelse(clave %in% c("N008", "N009"),
                                               gasto_tri, 0),
                            child_care = ifelse(clave %in% c("E012"),
                                                gasto_tri, 0),
                            child_exp  = ifelse(!is.na(clave),
                                                as.integer(clave == "E012"), NA),
                            day_care = ifelse(clave %in% c("E008"),
                                                gasto_tri, 0),
                            day_exp  = ifelse(!is.na(clave),
                                                as.integer(clave == "E008"), NA)
                            )

GasH = GasEni %>% group_by(folioviv, foliohog) %>%
  summarise(health_ins = sum(health_ins, na.rm = T),
            other_ins  = sum(other_ins, na.rm = T),
            child_care = sum(child_care, na.rm = T),
            child_exp  = sum(child_exp, na.rm = T),
            day_care   = sum(day_care, na.rm = T),
            day_exp    = sum(day_exp, na.rm = T))

PobH = PobEni %>% group_by(folioviv, foliohog) %>%
  summarise(age_hhead = edad[which(parentesco == 101)],
            age_hspouse = first(edad[parentesco %in% c(201,202)]),
            married = edo_conyug[which(parentesco == 101)])

ConcEni = ConcEni %>% left_join(VivEni, by = c("folioviv"))

ConcEni = ConcEni %>% left_join(GasH, by = c("folioviv",
                                              "foliohog"))

ConcEni = ConcEni %>% left_join(PobH, by = c("folioviv",
                                              "foliohog"))

ConcEni = ConcEni %>% 
  filter(clase_hog == 2)

ConcEni = ConcEni %>% mutate(Income = ing_cor - ingtrab,
                              Food =  ali_dentro + ali_fuera,
                              Transportation = transporte,
                              HealthService = salud,
                              Utilities = pred_cons + agua + energia,
                              Education = educacion,
                              HouseKeeping = cuidados,
                              Rent = ifelse(homeownership == 0, alquiler, estim_alqu),
                              Insurance = health_ins + other_ins,
                              Health_ins = health_ins,
                              Home_ins = other_ins,
                              Childc = day_care + child_care)

vars_to_summarise = c("Income", "Food", "Transportation", "HealthService", "Utilities", 
                       "Education", "HouseKeeping", "Rent", "Insurance", "Health_ins", 
                       "Home_ins", "Childc")

tabela_resumo = ConcEni %>%
  filter(married %in% c(1, 2)) %>%
  group_by(married) %>%
  summarise(
    across(all_of(vars_to_summarise),
           list(Mean = ~mean(.x, na.rm = TRUE),
                Median = ~median(.x, na.rm = TRUE)))
  )

tabela_resumo
```

# Question 2


# Question 3


# Question 4
## Item a
### Interior solution
Considering positive work in both period 1 and 2, our Lagrangian is

$$\mathcal{L}=\sum_{t=1}^{3}\beta^{t-1}[\alpha \ln C_t+(1-\alpha)\ln L_t]-\lambda \left [\sum_{t=1}^{3} \frac{C_t}{(1+r)^{t-1}}-A_1-\sum_{t=1}^{2}\frac{w_t(L_0-L_t)}{(1+r)^{t-1}}\right]$$

with CPO's:

$$
\begin{aligned}
\,
[C_t] &: \frac{\alpha\beta^{t-1}}{C_t}-\frac{\lambda}{(1+r)^{t-1}}=0 \Longrightarrow C_t^*=\frac{\alpha[\beta(1+r)]^{t-1}}{\lambda} \\
[L_t] &: \frac{(1-\alpha)\beta^{t-1}}{L_t}-\frac{\lambda w_t}{(1+r)^{t-1}}=0 \Longrightarrow L_t^*=\frac{(1-\alpha)[\beta(1+r)]^{t-1}}{\lambda w_t}
\end{aligned}
$$

Then, the Frischian labor supply function is simple

$$
h_t^F(w_t, \lambda, t)=L_0-L_t^*=L_0-\frac{(1-\alpha)[\beta(1+r)]^{t-1}}{\lambda w_t}
$$

Recall that the Marshallian elasticity accounts for variations in labor supply due to permanent shocks in the path of wage. So, to find the Marshallian labor supply function, we need to substitute $C_t^*$ and $L_t^*$ into the budget constraint and isolate $\lambda$ to find a close expression for the Lagrangean multiplier, i. e.,

$$
\begin{aligned}
\sum_{t=1}^{3} \frac{C_t^*}{(1+r)^{t-1}}-A_1-\sum_{t=1}^{2}\frac{w_t(L_0-L_t^*)}{(1+r)^{t-1}} &= 0 \\
\sum_{t=1}^{3} \frac{1}{(1+r)^{t-1}} \cdot \frac{\alpha[\beta(1+r)]^{t-1}}{\lambda}-A_1-\sum_{t=1}^{2}\left[\frac{w_tL_0}{(1+r)^{t-1}}-\frac{w_t}{(1+r)^{t-1}}\cdot \frac{(1-\alpha)[\beta(1+r)]^{t-1}}{\lambda w_t}\right] &= 0 \\
\sum_{t=1}^{3} \frac{\alpha \beta^{t-1}}{\lambda}-A_1-\sum_{t=1}^{2}\left[\frac{w_tL_0}{(1+r)^{t-1}}-\frac{(1-\alpha)\beta^{t-1}}{\lambda}\right] &= 0 \\
\frac{\alpha}{\lambda}\sum_{t=1}^{3}\beta^{t-1}-A_1-L_0\sum_{t=1}^{2}\frac{w_t}{(1+r)^{t-1}}+\frac{(1-\alpha)}{\lambda}\sum_{t=1}^{2}\beta^{t-1} &= 0
\end{aligned}
$$

As we know

$$
\sum_{t=1}^{T}\beta^{t-1}=\frac{1-\beta^T}{1-\beta}
$$
So, we have

$$
\begin{aligned}
A_1+L_0\sum_{t=1}^{2}\frac{w_t}{(1+r)^{t-1}} &= \frac{1}{\lambda(1-\beta)}[\alpha(1-\beta^3)+(1-\alpha)(1-\beta^2)] \\
\lambda \left[A_1+L_0 \left(w_1+\frac{w_2}{(1+r)}\right)\right] &= \frac{1-\alpha \beta^3+(1-\alpha)\beta^2}{(1-\beta)} \\
\lambda \left [\frac{(1+r)(A_1+L_0 w_1)+w_2}{(1+r)} \right] &= \frac{1-\alpha \beta^3+(1-\alpha)\beta^2}{(1-\beta)} \\
\lambda^* &= \frac{(1+r)[1-\alpha \beta^3+(1-\alpha)\beta^2]}{(1-\beta)[(1+r)(A_1+L_0 w_1)+w_2]}
\end{aligned}
$$
Therefore, the Marshallian labor supply function is:

$$
\begin{aligned}
h_t^M(w_t, \lambda^*, t) &= L_0-\frac{(1-\alpha)[\beta(1+r)]^{t-1}}{\lambda^* w_t} \\
h_t^M(w_t, \lambda^*, t) &= L_0-\frac{\gamma(1-\alpha)[\beta(1+r)]^{t-1}}{w_t}
\end{aligned}
$$

where
$$
\gamma = \frac{(1-\beta)[(1+r)(A_1+L_0 w_1)+w_2]}{(1+r)[1-\alpha \beta^3+(1-\alpha)\beta^2]}
$$

### Corner solution
We have two cases to consider here:

1. **Work only in period 1 ($L_2=L_0$)**

In this case, the budget constraint will be

$$
\sum_{t=1}^{3} \frac{C_t}{(1+r)^{t-1}}=A_1+w_1(L_0-L_1)
$$
Notice that in this case we just need to choose $C_t$ and $L_1$, so the Lagrangean will be

$$
\mathcal{L}=\sum_{t=1}^{3}\beta^{t-1}\alpha \ln C_t+(1-\alpha)\ln L_1 + (\beta+\beta^2)(1-\alpha)L_0 + \lambda\left [A_1 + w_1(L_0-L_1)-\sum_{t=1}^3\frac{C_t}{(1+r)^{t-1}} \right]
$$

Then, from FOC we get and repeating the previous process, we get

$$
\begin{aligned}
h_1^F(w_1, \lambda)&=L_0-\frac{1-\alpha}{\lambda w_1} \\
h_1^M(w_1, \lambda^*, t)&=L_0-\frac{\gamma'(1-\alpha)}{w_1}
\end{aligned}
$$

where here

$$
\gamma'=\frac{(1-\beta)[A_1+w_1L_0]}{1-[1-\alpha(1-\beta^2)]\beta}
$$

2. **Work only in period 2 ($L_1=L_0$)**

The budget constraint in this case is

$$
\sum_{t=1}^{3} \frac{C_t}{(1+r)^{t-1}}=A_1+\frac{w_2(L_0-L_2)}{(1+r)}
$$
The Lagrangean then will be

$$
\mathcal{L}=\sum_{t=1}^{3}\beta^{t-1}\alpha \ln C_t+\beta(1-\alpha)\ln L_2 + (1+\beta^2)(1-\alpha)L_0 + \lambda\left [A_1 + \frac{w_2(L_0-L_2)}{(1+r)}-\sum_{t=1}^3\frac{C_t}{(1+r)^{t-1}} \right]
$$

Repeating the process above yields

$$
\begin{aligned}
h_2^F(w_2, \lambda)&=L_0-\frac{\beta(1-\alpha)(1+r)}{\lambda w_2} \\
h_2^M(w_2, \lambda^*, t)&=L_0-\frac{\gamma''(1-\alpha)}{w_2}
\end{aligned}
$$
where

$$
\gamma''=\frac{(1-\beta[(1+r)A_1+w_2L_0])}{(1+r)[\alpha(1-\beta^3)+(1-\alpha)\beta(1-\beta)]}
$$